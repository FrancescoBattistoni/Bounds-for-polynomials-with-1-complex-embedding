
/* INNER */  

  R(x,y,z,a,g)=2*(1+x*y*z)*(1-x*y*z*a)*(1-2*y*z*g+(y*z)^2)*(1-y*z)*(1+y*z*a)*(1+2*z*g+z^2)*(1+z)*(1-z*a)*(1-g)*(1+2*a*g+a^2)*(1+a);

/* CASE 1.1: res1Nga = res2Nga = x^2*a^3 - 1/2*x^2*a^2 + 1/2*x^2*a + 3/4*x*a^3 - 3/2*x*a^2 + 5/4*x*a - 1/2*x - 1/2*a^2 + a - 1/2 */

  {res1NNg=
  z^71 - 29692/255*z^70 + 19558297/3060*z^69 - 2716280639/12240*z^68 + 359474778223/65280*z^67 - 
      6821061025507/65280*z^66 + 2479881302588213/1566720*z^65 - 5149132881177229/261120*z^64 + 
      431251195948012127/2088960*z^63 - 1285209059947834883/696320*z^62 + 
      11920464164477060989/835584*z^61 - 2411793039619825964971/25067520*z^60 + 
      6350485213435223157497/11141120*z^59 - 14940085825953045707077/5013504*z^58 + 
      614034066523925746143539/44564480*z^57 - 70594096877310251603293/1253376*z^56 + 
      162636908125555997501415223/802160640*z^55 - 3546200700301774283361249/5570560*z^54 + 
      85647132016966546038863579/50135040*z^53 - 1000172870807162770744595083/267386880*z^52 + 
      9342181687882080962484244357/1604321280*z^51 - 105214804786366623118662517/50135040*z^50 - 
      2640974834133058786363151530837/102676561920*z^49 + 
      2978588702554990619994814267613/25669140480*z^48 - 
      43353999836770190619554357286473/136902082560*z^47 + 
      251386471347564145894946568146063/410706247680*z^46 - 
      603102716304858436373552550140869/821412495360*z^45 - 
      198607243959492255527869329005257/1642824990720*z^44 + 
      22293502771382367971821483922526853/6571299962880*z^43 - 
      2273278967562513947705812457594927/219043332096*z^42 + 
      172796432814269248364486123612608279/8761733283840*z^41 - 
      6802837213270578839652583993503543/292057776128*z^40 + 
      2312622463288646485738823511658159/657129996288*z^39 + 
      1600117548603387112466206408902709379/26285199851520*z^38 - 
      6080398238601492623387721952603197001/35046933135360*z^37 + 
      6017704259063302825577883147734292061/21028159881216*z^36 - 
      4861239489488252006121939446273805371/17523466567680*z^35 - 
      801948753275051739136813903723979743/70093866270720*z^34 + 
      68421071493731220775886081953087963391/105140799406080*z^33 - 
      101553105491619285576669910640627847229/70093866270720*z^32 + 
      24632863926346456675520681423447760007/13142599925760*z^31 - 
      105505887777346635950839583932016642077/84112639524864*z^30 - 
      151077198455294658249583460319358341367/210281598812160*z^29 + 
      85342750142471267699041489602132339373/24739011624960*z^28 - 
      189062908200641955247982442718850940347/35046933135360*z^27 + 
      679309227298872547043885072029991012683/140187732541440*z^26 - 
      124306616233249567414291258026022903607/98956046499840*z^25 - 
      6547633807889909787800327246349430898977/1682252790497280*z^24 + 
      2143339329427488269885687680175645880833/280375465082880*z^23 - 
      5050359082831097232897995974869048421697/672901116198912*z^22 + 
      334885001812699392883338237350638234639/98956046499840*z^21 + 
      28157744620881204331849119597725149951/13194139533312*z^20 - 
      2103843243797348484936103944523053250713/373833953443840*z^19 + 
      800277512404772668753732007446833552573/149533581377536*z^18 - 
      1732932990794774065671674156433758440743/747667906887680*z^17 - 
      328387339614531245196207384296904172041/373833953443840*z^16 + 
      168757116531227019864832722044241319155/74766790688768*z^15 - 
      1271394073387245286276859649996819178371/747667906887680*z^14 + 
      80048171389532991461396919241607764017/186916976721920*z^13 + 
      72737047415007818637158580395469688809/186916976721920*z^12 - 
      173244195789695141368191653940039678483/373833953443840*z^11 + 
      136462623534578973402051335836071131457/747667906887680*z^10 + 
      24702835470024356756963238688102962279/747667906887680*z^9 - 
      6606806495919336095514241714635246489/93458488360960*z^8 + 
      5123135274327025452022097503343572713/186916976721920*z^7 + 
      2565686886476808355457957356300605243/747667906887680*z^6 - 
      1225654039682050322859366674754088227/186916976721920*z^5 + 
      73145063082798785502187058386801899/46729244180480*z^4 + 
      176006984577968322625144947115532247/373833953443840*z^3 - 
      24569138214367972131945220372838529/93458488360960*z^2 - 
      31412382001665735135938189344461/18691697672192*z + 
      83977460396085356224217613917397/5841155522560
  ;}
  
  {res1NNa=
  z^10*g^2 + 1/2*z^10*g - 1/2*z^10 + 6*z^9*g^3 + 1/2*z^9*g^2 - 5/2*z^9*g + 3*z^9 + 9*z^8*g^4 - 
      8*z^8*g^3 + z^8*g^2 + 18*z^8*g - 27/4*z^8 - 15*z^7*g^4 - 5/2*z^7*g^3 + 179/8*z^7*g^2 - 
      381/8*z^7*g + 67/4*z^7 - 42*z^6*g^4 - 1/2*z^6*g^3 - 2919/16*z^6*g^2 + 2571/32*z^6*g - 973/32*z^6
      + 37/2*z^5*g^4 - 1413/4*z^5*g^3 + 2753/16*z^5*g^2 - 4187/16*z^5*g + 259/8*z^5 - 161/2*z^4*g^4 + 
      2185/8*z^4*g^3 - 12075/16*z^4*g^2 + 5017/32*z^4*g - 3047/32*z^4 + 409/2*z^3*g^4 - 3453/8*z^3*g^3
      + 2993/8*z^3*g^2 - 4565/8*z^3*g + 205/8*z^3 - 189/2*z^2*g^4 + 3999/8*z^2*g^3 - 8903/16*z^2*g^2 +
      3513/32*z^2*g - 4951/32*z^2 - 945/8*z*g^3 + 6399/16*z*g^2 - 5025/16*z*g - 91/4*z - 567/16*g^2 + 
      3267/32*g - 2349/32
  ;}
  
  {res2NNx=
  z^2*a - z^2 - 3/2*z*a^2 + 7/2*z*a + z - 7/2*a^2 - 3/2*a
  ;}
  
  {res2NNy=
  x^2*z^2*a^2 - x^2*z*a^2 + 2*x^2*a^2 + x*z^2*a^2 - x*z^2*a - 3/2*x*z*a^2 + 3/2*x*z*a + 3/2*x*a^2 - 
      3/2*x*a - z*a^2 + 2*z*a - z
  ;}
  
  {Lx=
  x*y*z*a + 1/2*a - 1/2
  ;}

  search(threshold)={
    tot=0;
    VZ=polrootsreal(res1NNg,[0,1]);
    if (#VZ > 0,
       
        print(#VZ);
        for(iz=1,#VZ,
           VG = polrootsreal(subst(res1NNa,z,VZ[iz]),[0,1]);
           if (#VG > 0,
      
              for(ig=1,#VG,
                    VA = polrootsreal(subst(subst(res2NNx,z,VZ[iz]),g,VG[ig]),[0,1]);
      
                    if(#VA>0,
                       for(ia=1,#VA, 
                             VX=polrootsreal(subst(subst(subst(res2NNy,z,VZ[iz]),g,VG[ig]),a,VA[ia]),[0,1]);
                             
                           if(#VX>0,
                              for(ix=1,#VX, 
                                    VY=polrootsreal(subst(subst(subst(subst(Lx,z,VZ[iz]),g,VG[ig]),a,VA[ia]),x,VX[ix]),[0,1]);
                                    /* Lx is linear in y */  
                                    if(#VY>0,
                                       tot+=1;
                                       value=R(VX[ix],VY[1],VZ[iz],VA[ia],VG[ig]);
                                       if(value > threshold,
                                           print("[x,y,z,a,g]=",[VX[ix],VY[1],VZ[iz],VA[ia],VG[ig]]);
                                           print("R(x,y,z,a,g)=",R(VX[ix],VY[1],VZ[iz],VA[ia],VG[ig]))
                                         )  
                                    );
                                  ); 
                              );
                           ); 
                       );
                  );
               );
            );
         );   
  print("number of stationary points: ",tot)
  };
  
  search(5.8);
  /* no stationary points here */


/* CASE 1.2: res1Ngb, res2Ng */
  {res1Nx=
  a^32 - 22664793275/3101960988*a^31 + 347626228162721/14656765668300*a^30 - 
      825151154139872839/18467524742058000*a^29 + 15398545101007291057/290863514687413500*a^28 - 
      534658115645581857589/13961448704995848000*a^27 + 
      228312129714773008277/20942173057493772000*a^26 + 
      5537336116275808605643/502612153379850528000*a^25 - 
      5703783091721929214801/301567292027910316800*a^24 + 
      142741676969201832382037/9047018760837309504000*a^23 - 
      153288269025071473349261/18094037521674619008000*a^22 + 
      1608791087464202796437/723761500866984760320*a^21 + 
      35455344884821559229239/36188075043349238016000*a^20 - 
      1341466429112016719863/804179445407760844800*a^19 + 
      43659263540790983712227/36188075043349238016000*a^18 - 
      2649603652531813437767/4523509380418654752000*a^17 + 
      1668827017416974467169/9047018760837309504000*a^16 - 
      430679862108478203073/36188075043349238016000*a^15 - 
      191776857368698538401/6031345840558206336000*a^14 + 
      166432644681062846899/6031345840558206336000*a^13 - 
      106806456399408290309/7237615008669847603200*a^12 + 
      29897899739337442333/5169725006192748288000*a^11 - 
      58854465488430100897/36188075043349238016000*a^10 + 
      2113234103604805807/9047018760837309504000*a^9 + 417456276480325577/6031345840558206336000*a^8 -
      836111099210414113/12062691681116412672000*a^7 + 184696179048697277/6031345840558206336000*a^6 -
      4573854530021797/502612153379850528000*a^5 + 68966613873029/35900868098560752000*a^4 - 
      71661947096183/251306076689925264000*a^3 + 395843296459/13961448704995848000*a^2 - 
      739501213/436295272031120250*a + 371591/8079542074650375
  ;}
  
  {res1Ngb=
  x^6*a^8 - 1/9*x^6*a^7 + 29/81*x^6*a^6 - 16/81*x^6*a^5 + 5/81*x^6*a^4 - 1/27*x^6*a^3 + 1/81*x^6*a^2 -
      4/3*x^5*a^9 + 151/54*x^5*a^8 - 397/162*x^5*a^7 + 289/162*x^5*a^6 - 34/27*x^5*a^5 + 35/54*x^5*a^4
      - 43/162*x^5*a^3 + 17/162*x^5*a^2 - 2/81*x^5*a + 4/9*x^4*a^10 - 76/27*x^4*a^9 + 1793/324*x^4*a^8
      - 1987/324*x^4*a^7 + 287/54*x^4*a^6 - 185/54*x^4*a^5 + 565/324*x^4*a^4 - 97/108*x^4*a^3 + 
      23/81*x^4*a^2 - 5/81*x^4*a + 1/81*x^4 + 2/3*x^3*a^10 - 103/36*x^3*a^9 + 497/81*x^3*a^8 - 
      5545/648*x^3*a^7 + 1283/162*x^3*a^6 - 3289/648*x^3*a^5 + 439/162*x^3*a^4 - 811/648*x^3*a^3 + 
      19/54*x^3*a^2 - 7/216*x^3*a - 1/162*x^3 + 1/4*x^2*a^10 - 35/24*x^2*a^9 + 2585/648*x^2*a^8 - 
      8405/1296*x^2*a^7 + 8657/1296*x^2*a^6 - 5969/1296*x^2*a^5 + 3053/1296*x^2*a^4 - 
      1127/1296*x^2*a^3 + 103/1296*x^2*a^2 + 37/432*x^2*a - 1/48*x^2 - 1/4*x*a^9 + 265/216*x*a^8 - 
      1663/648*x*a^7 + 335/108*x*a^6 - 1591/648*x*a^5 + 193/162*x*a^4 - 85/648*x*a^3 - 61/324*x*a^2 + 
      5/72*x*a + 1/648*x + 5/81*a^8 - 107/324*a^7 + 56/81*a^6 - 217/324*a^5 + 35/162*a^4 + 35/324*a^3 
      - 7/81*a^2 + 1/324*a + 1/162
  ;}
  
  {res1Nz=
  x^3*a^3 - 2*x^3*a^2*g - x^3*a^2 + 2*x^2*a^3*g + x^2*a^3 - 4*x^2*a^2*g - 2*x^2*a^2 + 2*x^2*a*g + 
      x^2*a + 3/2*x*a^3*g + 3/4*x*a^3 - 3*x*a^2*g - 9/4*x*a^2 + 3/2*x*a*g + 9/4*x*a - 3/4*x + 1/2*a^3  
      - 3/2*a^2 + 3/2*a - 1/2
  ;}

  {res2Ny=
  x^2*z^2*a^2 - x^2*z*a^2 + 2*x^2*a^2 + x*z^2*a^2 - x*z^2*a - 3/2*x*z*a^2 + 3/2*x*z*a + 3/2*x*a^2 - 
      3/2*x*a - z*a^2 + 2*z*a - z
  ;}

  {Lx=
  x*y*z*a + 1/2*a - 1/2
  ;}

  search(threshold)={
    tot=0;
    VA=polrootsreal(res1Nx,[0,1]);
    if (#VA > 0,
       
        print(#VA);
        for(ia=1,#VA,
           VX = polrootsreal(subst(res1Ngb,a,VA[ia]),[0,1]);
           if (#VX > 0,
      
              for(ix=1,#VX,
                    VG = polrootsreal(subst(subst(res1Nz,a,VA[ia]),x,VX[ix]),[0,1]);
      
                    if(#VG>0,
                       for(ig=1,#VG, 
                             VZ=polrootsreal(subst(subst(subst(res2Ny,a,VA[ia]),x,VX[ix]),g,VG[ig]),[0,1]);
                             
                           if(#VZ>0,
                              for(iz=1,#VZ, 
                                    VY=polrootsreal(subst(subst(subst(subst(Lx,a,VA[ia]),x,VX[ix]),g,VG[ig]),z,VZ[iz]),[0,1]);
                                    /* Lx is linear in y */  
                                    if(#VY>0,
                                       tot+=1;
                                       value=R(VX[ix],VY[1],VZ[iz],VA[ia],VG[ig]);
                                       if(value > threshold,
                                           print("[x,y,z,a,g]=",[VX[ix],VY[1],VZ[iz],VA[ia],VG[ig]]);
                                           print("R(x,y,z,a,g)=",R(VX[ix],VY[1],VZ[iz],VA[ia],VG[ig]))
                                         )  
                                    );
                                  ); 
                              );
                           ); 
                       );
                  );
               );
            );
         );   
  print("number of stationary points: ",tot)
  };
  
  search(5.8);
  /* no stationary points here */


  /* CASE 2: res1gb, res2gb */
  {res1y=
  z^48 - 40781896489/1675145472*z^47 + 800755758638929/16885466357760*z^46 + 
      24563120671305943/28946513756160*z^45 + 12952071733311448123/14589042933104640*z^44 - 
      3522461894247856411717/1400548121578045440*z^43 - 
      125717647973165367927473/33613154917873090560*z^42 + 
      274127752656109664563967/134452619671492362240*z^41 + 
      1416034928160677154585173/268905239342984724480*z^40 + 
      1900977276051246426248407/1290745148846326677504*z^39 - 
      20629512335693558295094297/8604967658975511183360*z^38 - 
      571367636896003912958829161/154889417861559201300480*z^37 - 
      682848470152624872648116449/464668253584677603901440*z^36 + 
      34783985545363899817141130701/14869384114709683324846080*z^35 + 
      10959856650102120238558874713/4956461371569894441615360*z^34 - 
      26549757310230531478160356651/118955072917677466598768640*z^33 - 
      160963064046875225800349330099/178432609376516199898152960*z^32 - 
      8109465210381787773517288687/18300780448873456399810560*z^31 + 
      8970954243039220379634336821/194653755683472218070712320*z^30 + 
      84650644804576728725413221133/329414048079722215196590080*z^29 + 
      420215630008734710432339108419/6423573937554583196333506560*z^28 - 
      169772233825735494696404108233/1712953050014555519022268416*z^27 - 
      255295505010586517275910855617/5138859150043666557066805248*z^26 + 
      10776215960663830310008692874079/231248661751964995068006236160*z^25 + 
      21268501289054439347123052844957/346872992627947492602009354240*z^24 - 
      5645273626860144158493743926547/693745985255894985204018708480*z^23 - 
      376959185787052782121036505981/8564765250072777595111342080*z^22 - 
      20252918450498784450387894594851/2081237955767684955612056125440*z^21 + 
      31787230605902107938775326445297/2081237955767684955612056125440*z^20 + 
      6272221714599808131551462121427/891959123900436409548024053760*z^19 - 
      7972815073761476255548918139329/4682785400477291150127126282240*z^18 - 
      31087862403864457495301458211521/18731141601909164600508505128960*z^17 - 
      2324150651908820520622601159723/4682785400477291150127126282240*z^16 - 
      229615083863739154311950753561/2675877371701309228644072161280*z^15 + 
      7522456123466644054227848549/43662334736384999068784394240*z^14 + 
      6043726930885513277695254461/43662334736384999068784394240*z^13 - 
      1373124877453657750694342789/340566210943802992736518275072*z^12 - 
      77232168294964304128635537679/2341392700238645575063563141120*z^11 - 
      120742254069908924507950260133/18731141601909164600508505128960*z^10 + 
      32568094548540184515455218511/9365570800954582300254252564480*z^9 + 
      6141154597554931581826480109/4682785400477291150127126282240*z^8 - 
      535347901809543673377311861/4682785400477291150127126282240*z^7 - 
      2806103315581821157074769/26606735229984608807540490240*z^6 - 
      24980505789319942757893/4129440388427946340500111360*z^5 + 
      2537694739225772350406599/780464233412881858354521047040*z^4 + 
      7463680209930476205301/23891762247333118112893501440*z^3 - 
      29772812152306276605679/585348175059661393765890785280*z^2 - 
      35043705793713421975/9005356539379406057936781312*z + 
      3545490115366734013/8362116786566591339512725504
  ;}

  {res1gb=
  y^8*z^14 - 103/36*y^8*z^12 - 109/36*y^8*z^11 - 43/36*y^8*z^10 - 1/6*y^8*z^9 + 161/32*y^7*z^14 + 
      529/64*y^7*z^13 + 1129/144*y^7*z^12 + 33/8*y^7*z^11 - 983/576*y^7*z^10 - 235/72*y^7*z^9 - 
      11/8*y^7*z^8 - 3/16*y^7*z^7 + y^6*z^14 - 529/64*y^6*z^13 - 1157/96*y^6*z^12 - 95/18*y^6*z^11 + 
      93/32*y^6*z^10 + 901/144*y^6*z^9 + 8687/2304*y^6*z^8 + 703/768*y^6*z^7 + 9/128*y^6*z^6 + 
      1129/144*y^5*z^12 + 95/18*y^5*z^11 - 89/24*y^5*z^10 - 583/96*y^5*z^9 - 5831/1536*y^5*z^8 - 
      14893/9216*y^5*z^7 - 407/768*y^5*z^6 - 283/3072*y^5*z^5 - 103/36*y^4*z^12 - 33/8*y^4*z^11 + 
      93/32*y^4*z^10 + 583/96*y^4*z^9 + 7907/2304*y^4*z^8 + 16487/9216*y^4*z^7 + 3169/2304*y^4*z^6 + 
      5495/9216*y^4*z^5 + 407/4608*y^4*z^4 + 109/36*y^3*z^11 - 983/576*y^3*z^10 - 901/144*y^3*z^9 - 
      5831/1536*y^3*z^8 - 16487/9216*y^3*z^7 - 739/576*y^3*z^6 - 241/576*y^3*z^5 + 19/512*y^3*z^4 + 
      227/9216*y^3*z^3 - 43/36*y^2*z^10 + 235/72*y^2*z^9 + 8687/2304*y^2*z^8 + 14893/9216*y^2*z^7 + 
      3169/2304*y^2*z^6 + 241/576*y^2*z^5 - 281/576*y^2*z^4 - 919/3072*y^2*z^3 - 17/384*y^2*z^2 + 
      1/6*y*z^9 - 11/8*y*z^8 - 703/768*y*z^7 - 407/768*y*z^6 - 5495/9216*y*z^5 + 19/512*y*z^4 + 
      919/3072*y*z^3 + 19/144*y*z^2 + 25/1152*y*z + 3/16*z^7 + 9/128*z^6 + 283/3072*z^5 + 407/4608*z^4
      - 227/9216*z^3 - 17/384*z^2 - 25/1152*z - 1/384
  ;}

  {res1x=
  y^2*z^4 + 4/3*y^2*z^3*g + 2/3*y^2*z^3 + 2/3*y^2*z^2*g + 1/3*y^2*z^2 - 4/3*y*z^3*g - 2/3*y*z^3 - 
      2*y*z^2*g^2 - 5/3*y*z^2*g - 1/3*y*z^2 - y*z*g^2 - y*z*g + 2/3*z^2*g + 1/3*z^2 + z*g^2 + z*g + 
      2/3*g^2 + 1/3*g
  ;}

  {res1a=
  x*y^3*z^3 - 4/3*x*y^2*z^2*g - 2/3*x*y^2*z^2 + 2/3*x*y*z*g + 1/3*x*y*z + 2/3*y^3*z^3 - y^2*z^2*g + 
      1/3*g
  ;}

  {Lx=
  x*y*z*a + 1/2*a - 1/2
  ;}

  search(threshold)={
    tot=0;
    VZ=polrootsreal(res1y,[0,1]);
    if (#VZ > 0,
       
        print(#VZ);
        for(iz=1,#VZ,
           VY = polrootsreal(subst(res1gb,z,VZ[iz]),[0,1]);
           if (#VY > 0,
      
              for(iy=1,#VY,
                    VG = polrootsreal(subst(subst(res1x,z,VZ[iz]),y,VY[iy]),[0,1]);
      
                    if(#VG>0,
                       for(ig=1,#VG, 
                             VX=polrootsreal(subst(subst(subst(res1a,z,VZ[iz]),y,VY[iy]),g,VG[ig]),[0,1]);
                             
                           if(#VX>0,
                              for(ix=1,#VX, 
                                    VA=polrootsreal(subst(subst(subst(subst(Lx,z,VZ[iz]),y,VY[iy]),g,VG[ig]),x,VX[ix]),[0,1]);
                                    /* Lx is linear in a */  
                                    if(#VA>0,
                                       tot+=1;
                                       value=R(VX[ix],VY[iy],VZ[iz],VA[1],VG[ig]);
                                       if(value > threshold,
                                           print("[x,y,z,a,g]=",[VX[ix],VY[iy],VZ[iz],VA[1],VG[ig]]);
                                           print("R(x,y,z,a,g)=",R(VX[ix],VY[iy],VZ[iz],VA[1],VG[ig]))
                                         )  
                                    );
                                  ); 
                              );
                           ); 
                       );
                  );
               );
            );
         );   
  print("number of stationary points: ",tot)
  };
  
  search(5.8);
  /* no stationary points here */
.........................................................................
